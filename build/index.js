(()=>{"use strict";var e={n:l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return e.d(a,{a}),a},d:(l,a)=>{for(var t in a)e.o(a,t)&&!e.o(l,t)&&Object.defineProperty(l,t,{enumerable:!0,get:a[t]})},o:(e,l)=>Object.prototype.hasOwnProperty.call(e,l)};const l=window.React,a=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,n=window.wp.element,o=window.wp.i18n,r=window.wp.apiFetch;var m=e.n(r);(0,a.registerBlockType)("immich-gallery/gallery",{edit:({attributes:e,setAttributes:a})=>{const{mode:r,album:s,albums:c,asset:p,show:d,order:g,size:_,title_size:u,description_size:b,date_size:h}=e,y=(0,t.useBlockProps)(),[v,x]=(0,n.useState)([]),[f,E]=(0,n.useState)(!0);(0,n.useEffect)(()=>{m()({path:"/immich-gallery/v1/albums"}).then(e=>{e&&e.albums&&x(e.albums),E(!1)}).catch(e=>{console.error("Error fetching albums:",e),E(!1)})},[]);const w=[{label:(0,o.__)("Select an album...","immich-gallery"),value:""},...v.sort((e,l)=>e.name.localeCompare(l.name)).map(e=>({label:e.name,value:e.id}))],C=[{label:(0,o.__)("Gallery name","immich-gallery"),value:"gallery_name"},{label:(0,o.__)("Gallery description","immich-gallery"),value:"gallery_description"},{label:(0,o.__)("Asset date","immich-gallery"),value:"asset_date"},{label:(0,o.__)("Asset description","immich-gallery"),value:"asset_description"}],S=[{label:(0,o.__)("Default","immich-gallery"),value:""},{label:(0,o.__)("Newest first","immich-gallery"),value:"date_desc"},{label:(0,o.__)("Oldest first","immich-gallery"),value:"date_asc"},{label:(0,o.__)("A-Z (albums only)","immich-gallery"),value:"name_asc"},{label:(0,o.__)("Z-A (albums only)","immich-gallery"),value:"name_desc"},{label:(0,o.__)("A-Z by description (photos only)","immich-gallery"),value:"description_asc"},{label:(0,o.__)("Z-A by description (photos only)","immich-gallery"),value:"description_desc"}];return(0,l.createElement)("div",{...y},(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(i.PanelBody,{title:(0,o.__)("Gallery Settings","immich-gallery"),initialOpen:!0},(0,l.createElement)(i.RadioControl,{label:(0,o.__)("Display Mode","immich-gallery"),selected:r,options:[{label:(0,o.__)("All albums overview","immich-gallery"),value:"overview"},{label:(0,o.__)("Single album","immich-gallery"),value:"single"},{label:(0,o.__)("Multiple albums","immich-gallery"),value:"multiple"},{label:(0,o.__)("Single photo","immich-gallery"),value:"asset"}],onChange:e=>{const l={mode:e};"asset"!==e&&(l.asset=""),"single"!==e&&(l.album=""),"multiple"!==e&&(l.albums=[]),a(l)}}),"asset"===r&&(0,l.createElement)(i.TextControl,{label:(0,o.__)("Photo ID","immich-gallery"),value:p,onChange:e=>a({asset:e}),placeholder:"e.g., 3c874076-ba9e-410a-8501-ef3cca897bcd",help:(0,o.__)("Enter the photo ID from your Immich URL","immich-gallery")}),"     ","single"===r&&(0,l.createElement)(i.SelectControl,{label:(0,o.__)("Select Album","immich-gallery"),value:s,options:w,onChange:e=>a({album:e}),disabled:f}),"multiple"===r&&!f&&v.length>0&&(0,l.createElement)("div",{style:{marginTop:"12px"}},(0,l.createElement)("label",{style:{fontWeight:600,marginBottom:"8px",display:"block"}},(0,o.__)("Select Albums","immich-gallery")),v.map(e=>(0,l.createElement)(i.CheckboxControl,{key:e.id,label:e.name,checked:c.includes(e.id),onChange:l=>((e,l)=>{const t=l?[...c,e]:c.filter(l=>l!==e);a({albums:t})})(e.id,l)}))),(0,l.createElement)(i.SelectControl,{label:(0,o.__)("Sort Order","immich-gallery"),value:g,options:S,onChange:e=>a({order:e})}),(0,l.createElement)(i.RangeControl,{label:(0,o.__)("Thumbnail Size","immich-gallery"),value:_||200,onChange:e=>a({size:e}),min:100,max:500,step:50})),(0,l.createElement)(i.PanelBody,{title:(0,o.__)("Text Sizes","immich-gallery"),initialOpen:!1},(0,l.createElement)(i.RangeControl,{label:(0,o.__)("Title Size","immich-gallery"),value:u||16,onChange:e=>a({title_size:e}),min:10,max:30,step:1}),(0,l.createElement)(i.RangeControl,{label:(0,o.__)("Description Size","immich-gallery"),value:b||14,onChange:e=>a({description_size:e}),min:10,max:30,step:1}),(0,l.createElement)(i.RangeControl,{label:(0,o.__)("Date Size","immich-gallery"),value:h||13,onChange:e=>a({date_size:e}),min:10,max:30,step:1})),"    ",(0,l.createElement)(i.PanelBody,{title:(0,o.__)("Display Options","immich-gallery"),initialOpen:!1},C.map(e=>(0,l.createElement)(i.CheckboxControl,{key:e.value,label:e.label,checked:d.includes(e.value),onChange:l=>((e,l)=>{const t=l?[...d,e]:d.filter(l=>l!==e);a({show:t})})(e.value,l)})))),(0,l.createElement)("div",{style:{padding:"20px",backgroundColor:"single"===r&&!s||"multiple"===r&&0===c.length||"asset"===r&&!p?"#fef2f2":"#f0f0f0",borderRadius:"4px",fontFamily:"monospace",fontSize:"13px",border:"single"===r&&!s||"multiple"===r&&0===c.length||"asset"===r&&!p?"2px solid #ef4444":"none"}},f?(0,l.createElement)("p",null,(0,o.__)("Loading albums...","immich-gallery")):(0,l.createElement)("div",null,(0,l.createElement)("p",{style:{marginBottom:"8px",fontWeight:"bold",fontSize:"14px"}},(0,o.__)("Immich Gallery","immich-gallery")),"single"===r&&!s&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,o.__)("⚠️ No album selected","immich-gallery")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,o.__)("Please select an album from the sidebar to display.","immich-gallery"))),"multiple"===r&&0===c.length&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,o.__)("⚠️ No albums selected","immich-gallery")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,o.__)("Please select at least one album from the sidebar to display.","immich-gallery"))),"asset"===r&&!p&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,o.__)("⚠️ No photo ID entered","immich-gallery")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,o.__)("Please enter a photo ID from your Immich server.","immich-gallery"))),(0,l.createElement)("code",{style:{display:"block",padding:"8px",backgroundColor:"white",borderRadius:"3px",fontSize:"12px"}},(()=>{let e="[immich_gallery";return"asset"===r&&p?e+=` asset="${p}"`:"single"===r&&s?e+=` album="${s}"`:"multiple"===r&&c.length>0&&(e+=` albums="${c.join(",")}"`),d&&d.length>0&&(e+=` show="${d.join(",")}"`),g&&(e+=` order="${g}"`),_&&200!==_&&(e+=` size="${_}"`),u&&16!==u&&(e+=` title_size="${u}"`),b&&14!==b&&(e+=` description_size="${b}"`),h&&13!==h&&(e+=` date_size="${h}"`),e+="]",e})()),"overview"===r&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,o.__)("Will display all albums from Immich","immich-gallery")),"asset"===r&&p&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,o.__)("Single photo: ","immich-gallery"),p.substring(0,8),"..."),"single"===r&&s&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,o.__)("Selected: ","immich-gallery"),v.find(e=>e.id===s)?.name||s),"multiple"===r&&c.length>0&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,o.__)("Selected albums: ","immich-gallery"),c.length))))},save:()=>null})})();