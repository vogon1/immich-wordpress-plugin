(()=>{"use strict";var e={n:l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return e.d(a,{a}),a},d:(l,a)=>{for(var i in a)e.o(a,i)&&!e.o(l,i)&&Object.defineProperty(l,i,{enumerable:!0,get:a[i]})},o:(e,l)=>Object.prototype.hasOwnProperty.call(e,l)};const l=window.React,a=window.wp.blocks,i=window.wp.blockEditor,t=window.wp.components,n=window.wp.element,m=window.wp.i18n,o=window.wp.apiFetch;var r=e.n(o);(0,a.registerBlockType)("immich-gallery/gallery",{edit:({attributes:e,setAttributes:a})=>{const{mode:o,album:s,albums:c,asset:p,show:_,order:g,size:d,title_size:u,description_size:h,date_size:y}=e,b=(0,i.useBlockProps)(),[v,E]=(0,n.useState)([]),[w,f]=(0,n.useState)(!0);(0,n.useEffect)(()=>{r()({path:"/immich-gallery/v1/albums"}).then(e=>{e&&e.albums&&E(e.albums),f(!1)}).catch(e=>{console.error("Error fetching albums:",e),f(!1)})},[]);const x=[{label:(0,m.__)("Select an album...","immich-gallery"),value:""},...v.map(e=>({label:e.name,value:e.id}))],S=[{label:(0,m.__)("Gallery name","immich-gallery"),value:"gallery_name"},{label:(0,m.__)("Gallery description","immich-gallery"),value:"gallery_description"},{label:(0,m.__)("Asset date","immich-gallery"),value:"asset_date"},{label:(0,m.__)("Asset description","immich-gallery"),value:"asset_description"}],C=[{label:(0,m.__)("Default","immich-gallery"),value:""},{label:(0,m.__)("Newest first","immich-gallery"),value:"date_desc"},{label:(0,m.__)("Oldest first","immich-gallery"),value:"date_asc"},{label:(0,m.__)("A-Z (albums only)","immich-gallery"),value:"name_asc"},{label:(0,m.__)("Z-A (albums only)","immich-gallery"),value:"name_desc"},{label:(0,m.__)("A-Z by description (photos only)","immich-gallery"),value:"description_asc"},{label:(0,m.__)("Z-A by description (photos only)","immich-gallery"),value:"description_desc"}];return(0,l.createElement)("div",{...b},(0,l.createElement)(i.InspectorControls,null,(0,l.createElement)(t.PanelBody,{title:(0,m.__)("Gallery Settings","immich-gallery"),initialOpen:!0},(0,l.createElement)(t.RadioControl,{label:(0,m.__)("Display Mode","immich-gallery"),selected:o,options:[{label:(0,m.__)("All albums overview","immich-gallery"),value:"overview"},{label:(0,m.__)("Single album","immich-gallery"),value:"single"},{label:(0,m.__)("Multiple albums","immich-gallery"),value:"multiple"},{label:(0,m.__)("Single photo","immich-gallery"),value:"asset"}],onChange:e=>{const l={mode:e};"asset"!==e&&(l.asset=""),"single"!==e&&(l.album=""),"multiple"!==e&&(l.albums=[]),a(l)}}),"asset"===o&&(0,l.createElement)(t.TextControl,{label:(0,m.__)("Photo ID","immich-gallery"),value:p,onChange:e=>a({asset:e}),placeholder:"e.g., 3c874076-ba9e-410a-8501-ef3cca897bcd",help:(0,m.__)("Enter the photo ID from your Immich URL","immich-gallery")}),"     ","single"===o&&(0,l.createElement)(t.SelectControl,{label:(0,m.__)("Select Album","immich-gallery"),value:s,options:x,onChange:e=>a({album:e}),disabled:w}),"multiple"===o&&!w&&v.length>0&&(0,l.createElement)("div",{style:{marginTop:"12px"}},(0,l.createElement)("label",{style:{fontWeight:600,marginBottom:"8px",display:"block"}},(0,m.__)("Select Albums","immich-gallery")),v.map(e=>(0,l.createElement)(t.CheckboxControl,{key:e.id,label:e.name,checked:c.includes(e.id),onChange:l=>((e,l)=>{const i=l?[...c,e]:c.filter(l=>l!==e);a({albums:i})})(e.id,l)}))),(0,l.createElement)(t.SelectControl,{label:(0,m.__)("Sort Order","immich-gallery"),value:g,options:C,onChange:e=>a({order:e})}),(0,l.createElement)(t.RangeControl,{label:(0,m.__)("Thumbnail Size","immich-gallery"),value:d,onChange:e=>a({size:e}),min:100,max:500,step:50})),(0,l.createElement)(t.PanelBody,{title:(0,m.__)("Text Sizes","immich-gallery"),initialOpen:!1},(0,l.createElement)(t.RangeControl,{label:(0,m.__)("Title Size","immich-gallery"),value:u,onChange:e=>a({title_size:e}),min:10,max:30,step:1}),(0,l.createElement)(t.RangeControl,{label:(0,m.__)("Description Size","immich-gallery"),value:h,onChange:e=>a({description_size:e}),min:10,max:30,step:1}),(0,l.createElement)(t.RangeControl,{label:(0,m.__)("Date Size","immich-gallery"),value:y,onChange:e=>a({date_size:e}),min:10,max:30,step:1})),"    ",(0,l.createElement)(t.PanelBody,{title:(0,m.__)("Display Options","immich-gallery"),initialOpen:!1},S.map(e=>(0,l.createElement)(t.CheckboxControl,{key:e.value,label:e.label,checked:_.includes(e.value),onChange:l=>((e,l)=>{const i=l?[..._,e]:_.filter(l=>l!==e);a({show:i})})(e.value,l)})))),(0,l.createElement)("div",{style:{padding:"20px",backgroundColor:"#f0f0f0",borderRadius:"4px",fontFamily:"monospace",fontSize:"13px"}},w?(0,l.createElement)("p",null,(0,m.__)("Loading albums...","immich-gallery")):(0,l.createElement)("div",null,(0,l.createElement)("p",{style:{marginBottom:"8px",fontWeight:"bold",fontSize:"14px"}},(0,m.__)("Immich Gallery","immich-gallery")),(0,l.createElement)("code",{style:{display:"block",padding:"8px",backgroundColor:"white",borderRadius:"3px",fontSize:"12px"}},(()=>{let e="[immich_gallery";return"asset"===o&&p?e+=` asset="${p}"`:"single"===o&&s?e+=` album="${s}"`:"multiple"===o&&c.length>0&&(e+=` albums="${c.join(",")}"`),_&&_.length>0&&(e+=` show="${_.join(",")}"`),g&&(e+=` order="${g}"`),d&&200!==d&&(e+=` size="${d}"`),u&&16!==u&&(e+=` title_size="${u}"`),h&&14!==h&&(e+=` description_size="${h}"`),y&&13!==y&&(e+=` date_size="${y}"`),e+="]",e})()),"overview"===o&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,m.__)("Will display all albums from Immich","immich-gallery")),"asset"===o&&p&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,m.__)("Single photo: ","immich-gallery"),p.substring(0,8),"..."),"single"===o&&s&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,m.__)("Selected: ","immich-gallery"),v.find(e=>e.id===s)?.name||s),"multiple"===o&&c.length>0&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,m.__)("Selected albums: ","immich-gallery"),c.length))))},save:()=>null})})();