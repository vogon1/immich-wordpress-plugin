(()=>{"use strict";var e={n:l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return e.d(a,{a}),a},d:(l,a)=>{for(var t in a)e.o(a,t)&&!e.o(l,t)&&Object.defineProperty(l,t,{enumerable:!0,get:a[t]})},o:(e,l)=>Object.prototype.hasOwnProperty.call(e,l)};const l=window.React,a=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,o=window.wp.element,r=window.wp.i18n,n=window.wp.apiFetch;var m=e.n(n);(0,a.registerBlockType)("gallery-for-immich/gallery",{edit:({attributes:e,setAttributes:a})=>{const{mode:n,album:s,albums:c,asset:p,show:d,order:g,size:_,title_size:u,description_size:b,date_size:h}=e,y=(0,t.useBlockProps)(),[f,v]=(0,o.useState)([]),[x,E]=(0,o.useState)(!0);(0,o.useEffect)(()=>{m()({path:"/gallery-for-immich/v1/albums"}).then(e=>{e&&e.albums&&v(e.albums),E(!1)}).catch(e=>{console.error("Error fetching albums:",e),E(!1)})},[]);const w=[{label:(0,r.__)("Select an album...","gallery-for-immich"),value:""},...f.sort((e,l)=>e.name.localeCompare(l.name)).map(e=>({label:e.name,value:e.id}))],C=[{label:(0,r.__)("Gallery name","gallery-for-immich"),value:"gallery_name"},{label:(0,r.__)("Gallery description","gallery-for-immich"),value:"gallery_description"},{label:(0,r.__)("Asset date","gallery-for-immich"),value:"asset_date"},{label:(0,r.__)("Asset description","gallery-for-immich"),value:"asset_description"}],S=[{label:(0,r.__)("Default","gallery-for-immich"),value:""},{label:(0,r.__)("Newest first","gallery-for-immich"),value:"date_desc"},{label:(0,r.__)("Oldest first","gallery-for-immich"),value:"date_asc"},{label:(0,r.__)("A-Z (albums only)","gallery-for-immich"),value:"name_asc"},{label:(0,r.__)("Z-A (albums only)","gallery-for-immich"),value:"name_desc"},{label:(0,r.__)("A-Z by description (photos only)","gallery-for-immich"),value:"description_asc"},{label:(0,r.__)("Z-A by description (photos only)","gallery-for-immich"),value:"description_desc"}];return(0,l.createElement)("div",{...y},(0,l.createElement)(t.InspectorControls,null,(0,l.createElement)(i.PanelBody,{title:(0,r.__)("Gallery Settings","gallery-for-immich"),initialOpen:!0},(0,l.createElement)(i.RadioControl,{label:(0,r.__)("Display Mode","gallery-for-immich"),selected:n,options:[{label:(0,r.__)("All albums overview","gallery-for-immich"),value:"overview"},{label:(0,r.__)("Single album","gallery-for-immich"),value:"single"},{label:(0,r.__)("Multiple albums","gallery-for-immich"),value:"multiple"},{label:(0,r.__)("Single photo","gallery-for-immich"),value:"asset"}],onChange:e=>{const l={mode:e};"asset"!==e&&(l.asset=""),"single"!==e&&(l.album=""),"multiple"!==e&&(l.albums=[]),a(l)}}),"asset"===n&&(0,l.createElement)(i.TextControl,{label:(0,r.__)("Photo ID","gallery-for-immich"),value:p,onChange:e=>a({asset:e}),placeholder:"e.g., 3c874076-ba9e-410a-8501-ef3cca897bcd",help:(0,r.__)("Enter the photo ID from your Immich URL","gallery-for-immich")}),"     ","single"===n&&(0,l.createElement)(i.SelectControl,{label:(0,r.__)("Select Album","gallery-for-immich"),value:s,options:w,onChange:e=>a({album:e}),disabled:x}),"multiple"===n&&!x&&f.length>0&&(0,l.createElement)("div",{style:{marginTop:"12px"}},(0,l.createElement)("label",{style:{fontWeight:600,marginBottom:"8px",display:"block"}},(0,r.__)("Select Albums","gallery-for-immich")),f.map(e=>(0,l.createElement)(i.CheckboxControl,{key:e.id,label:e.name,checked:c.includes(e.id),onChange:l=>((e,l)=>{const t=l?[...c,e]:c.filter(l=>l!==e);a({albums:t})})(e.id,l)}))),(0,l.createElement)(i.SelectControl,{label:(0,r.__)("Sort Order","gallery-for-immich"),value:g,options:S,onChange:e=>a({order:e})}),(0,l.createElement)(i.RangeControl,{label:(0,r.__)("Thumbnail Size","gallery-for-immich"),value:_||200,onChange:e=>a({size:e}),min:100,max:500,step:50})),(0,l.createElement)(i.PanelBody,{title:(0,r.__)("Text Sizes","gallery-for-immich"),initialOpen:!1},(0,l.createElement)(i.RangeControl,{label:(0,r.__)("Title Size","gallery-for-immich"),value:u||16,onChange:e=>a({title_size:e}),min:10,max:30,step:1}),(0,l.createElement)(i.RangeControl,{label:(0,r.__)("Description Size","gallery-for-immich"),value:b||14,onChange:e=>a({description_size:e}),min:10,max:30,step:1}),(0,l.createElement)(i.RangeControl,{label:(0,r.__)("Date Size","gallery-for-immich"),value:h||13,onChange:e=>a({date_size:e}),min:10,max:30,step:1})),"    ",(0,l.createElement)(i.PanelBody,{title:(0,r.__)("Display Options","gallery-for-immich"),initialOpen:!1},C.map(e=>(0,l.createElement)(i.CheckboxControl,{key:e.value,label:e.label,checked:d.includes(e.value),onChange:l=>((e,l)=>{const t=l?[...d,e]:d.filter(l=>l!==e);a({show:t})})(e.value,l)})))),(0,l.createElement)("div",{style:{padding:"20px",backgroundColor:"single"===n&&!s||"multiple"===n&&0===c.length||"asset"===n&&!p?"#fef2f2":"#f0f0f0",borderRadius:"4px",fontFamily:"monospace",fontSize:"13px",border:"single"===n&&!s||"multiple"===n&&0===c.length||"asset"===n&&!p?"2px solid #ef4444":"none"}},x?(0,l.createElement)("p",null,(0,r.__)("Loading albums...","gallery-for-immich")):(0,l.createElement)("div",null,(0,l.createElement)("p",{style:{marginBottom:"8px",fontWeight:"bold",fontSize:"14px"}},(0,r.__)("Gallery for Immich","gallery-for-immich")),"single"===n&&!s&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,r.__)("⚠️ No album selected","gallery-for-immich")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,r.__)("Please select an album from the sidebar to display.","gallery-for-immich"))),"multiple"===n&&0===c.length&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,r.__)("⚠️ No albums selected","gallery-for-immich")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,r.__)("Please select at least one album from the sidebar to display.","gallery-for-immich"))),"asset"===n&&!p&&(0,l.createElement)("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"4px",marginBottom:"12px",color:"#991b1b"}},(0,l.createElement)("strong",null,(0,r.__)("⚠️ No photo ID entered","gallery-for-immich")),(0,l.createElement)("p",{style:{margin:"4px 0 0 0",fontSize:"12px"}},(0,r.__)("Please enter a photo ID from your Immich server.","gallery-for-immich"))),(0,l.createElement)("code",{style:{display:"block",padding:"8px",backgroundColor:"white",borderRadius:"3px",fontSize:"12px"}},(()=>{let e="[gallery_for_immich";return"asset"===n&&p?e+=` asset="${p}"`:"single"===n&&s?e+=` album="${s}"`:"multiple"===n&&c.length>0&&(e+=` albums="${c.join(",")}"`),d&&d.length>0&&(e+=` show="${d.join(",")}"`),g&&(e+=` order="${g}"`),_&&200!==_&&(e+=` size="${_}"`),u&&16!==u&&(e+=` title_size="${u}"`),b&&14!==b&&(e+=` description_size="${b}"`),h&&13!==h&&(e+=` date_size="${h}"`),e+="]",e})()),"overview"===n&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,r.__)("Will display all albums from Immich","gallery-for-immich")),"asset"===n&&p&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,r.__)("Single photo: ","gallery-for-immich"),p.substring(0,8),"..."),"single"===n&&s&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,r.__)("Selected: ","gallery-for-immich"),f.find(e=>e.id===s)?.name||s),"multiple"===n&&c.length>0&&(0,l.createElement)("p",{style:{marginTop:"8px",fontSize:"11px",color:"#666"}},(0,r.__)("Selected albums: ","gallery-for-immich"),c.length))))},save:()=>null})})();